# A plotting R script produced by the Revigo server at http://revigo.irb.hr/
# If you found Revigo useful in your work, please cite the following reference:
# Supek F et al. "REVIGO summarizes and visualizes long lists of Gene Ontology
# terms" PLoS ONE 2011. doi:10.1371/journal.pone.0021800

# --------------------------------------------------------------------------
# If you don't have the ggplot2 package installed, uncomment the following line:
# install.packages( "ggplot2" );
library( ggplot2 );

# --------------------------------------------------------------------------
# If you don't have the scales package installed, uncomment the following line:
# install.packages( "scales" );
library( scales );

# --------------------------------------------------------------------------
# Here is your data from Revigo. Scroll down for plot configuration options.

revigo.names <- c("term_ID","description","frequency","plot_X","plot_Y","log_size","value","uniqueness","dispensability");
revigo.data <- rbind(c("GO:0002181","cytoplasmic translation",0.12046428693071752,-5.190287051509591,2.2445245108646925,4.5589244643947815,2.043681121,0.9083064508372601,0.16556618),
c("GO:0002376","immune system process",0.5358776487042264,8.264591214822898,4.239051810809912,5.207122497650964,1.274928006,0.9848475137235947,0.00781305),
c("GO:0002753","cytosolic pattern recognition receptor signaling pathway",0.005740987912925379,5.835593288216306,0.7571276471247476,3.237292337567459,2.051194654,0.6969342808269611,0.42569584),
c("GO:0005975","carbohydrate metabolic process",5.521546466478484,-1.8524068681542087,5.91147927225425,6.220115151808519,1.193422344,0.9601434285758441,0.09441481),
c("GO:0006412","translation",5.085673767131161,-5.145588690062679,1.7821475919870902,6.184402940776566,1.406533477,0.8752155999197063,0.57750679),
c("GO:0006470","protein dephosphorylation",0.4858252813150601,-5.341031644443081,0.17465462572981044,5.164537243060306,1.352436036,0.8883926694068028,0.64699371),
c("GO:0006508","proteolysis",5.350747086797883,-5.317180017062853,1.254226798076954,6.206468852551757,1.307187247,0.8970626282014635,0.28285178),
c("GO:0006607","NLS-bearing protein import into nucleus",0.003775215110759157,-1.91643962688762,-6.060687654757331,3.055378331375,1.640955724,0.9336856934170092,0.59044746),
c("GO:0006629","lipid metabolic process",4.558650411488468,1.0040413481457997,7.9082421448452305,6.136890764559154,1.14695863,0.9609168290058497,0.04396617),
c("GO:0006633","fatty acid biosynthetic process",0.7436109390366955,-4.413512045850493,4.686322573395024,5.349401871396483,1.465139039,0.9265424542506753,0.58556976),
c("GO:0006672","ceramide metabolic process",0.0837731874709957,-5.112061770524937,3.967276219469571,4.401176442169203,1.654745267,0.9198267255551604,0.37831642),
c("GO:0006879","intracellular iron ion homeostasis",0.1116864960256132,-2.379752127139155,-2.1561598030969376,4.526067758480154,1.442598438,0.9785058655286739,0.60008793),
c("GO:0006979","response to oxidative stress",0.5712981471310761,4.436954004554638,4.853165683765466,5.23491950292478,1.318625135,0.8843827423773102,0.48191891),
c("GO:0006986","response to unfolded protein",0.058241424307835105,5.0005799635020365,5.04441515027226,4.243310948029823,1.713085645,0.8797121613234442,0.51582826),
c("GO:0006997","nucleus organization",0.042425435011218544,1.9750528960516067,-7.12302068074468,4.105714510570921,1.758166847,0.9335377777598987,0.40378836),
c("GO:0007034","vacuolar transport",0.19504391090731824,-1.606339449477745,-6.063079251226495,4.768193961633072,2.344222462,0.9302733576878432,0.37736995),
c("GO:0007155","cell adhesion",0.7060783158562494,-2.6698133794968557,6.89049209790323,5.326909078957348,1.260188954,0.9845086986708523,0.00960027),
c("GO:0007163","establishment or maintenance of cell polarity",0.0687554815458172,0.5083695464237739,7.216894073683351,4.3153824963149905,1.528840736,0.9869622261951373,0.0059658),
c("GO:0007166","cell surface receptor signaling pathway",1.1935334257213288,5.055170774686558,1.5848862925372267,5.554889955407091,1.306615799,0.7715053310144695,0.33047757),
c("GO:0007169","transmembrane receptor protein tyrosine kinase signaling pathway",0.156466866982574,4.989142380875056,1.9996963623478254,4.672485777576998,1.453417927,0.7876697549712816,0.65025767),
c("GO:0007175","negative regulation of epidermal growth factor-activated receptor activity",0.0030600862571792285,4.843295505270293,-1.9228549097866088,2.964259630196849,2.344222462,0.7374972504682238,0.17826178),
c("GO:0007229","integrin-mediated signaling pathway",0.09143005547537242,4.840828665347432,2.108411998577946,4.439158941284675,1.775926108,0.7945363500082916,0.51961427),
c("GO:0007519","skeletal muscle tissue development",0.021676719715257645,-5.333950230534697,-4.466929130259843,3.8141143561291253,1.455034632,0.9602803600845807,0.52056804),
c("GO:0007586","digestion",0.023679080505281443,-4.608548668737147,-3.75445927370645,3.8524799936368566,1.918000196,0.9665501445866314,0.38546454),
c("GO:0008333","endosome to lysosome transport",0.009140344602965781,-1.4984901948478335,-6.363799676542843,3.4391747398434687,1.37895439,0.9408496226487713,0.49078727),
c("GO:0008360","regulation of cell shape",0.6890449444181898,4.8463790937404605,-3.244916064945221,5.316303805920243,1.262273633,0.800876080842463,0.63279923),
c("GO:0009086","methionine biosynthetic process",0.3310381355932203,-4.267674302419071,3.9968255275265463,4.997936549906475,1.953518719,0.9147491040866625,0.27784466),
c("GO:0009611","response to wounding",0.11923027388570284,4.6029905567969625,5.101065792553879,4.554452815848653,1.562814975,0.896096691816477,0.36206929),
c("GO:0009615","response to virus",0.1725522769170509,3.865405195403876,5.467614483359556,4.714983224819396,1.442598438,0.8822551485498739,0.63069328),
c("GO:0010225","response to UV-C",0.0020156655128811003,2.7566335307045753,4.899443390698901,2.7831886910752575,1.87537797,0.9282818930586656,0.16444721),
c("GO:0010332","response to gamma radiation",0.008561589158673189,3.045440958201965,4.770174245666078,3.41077723337721,1.674444616,0.9228804116122594,0.61215064),
c("GO:0010498","proteasomal protein catabolic process",0.3541118512084946,-3.909496330046302,1.6042862964533533,5.027198699908206,1.781609071,0.8495499186526678,0.68117063),
c("GO:0015804","neutral amino acid transport",0.03982768787333052,-2.464041260139482,-5.226949288306661,4.078275522086601,2.009333539,0.9441046654461925,0.14798365),
c("GO:0015914","phospholipid transport",0.1207902526407214,-2.464401444061327,-5.741880757782084,4.5600980074263,1.704889063,0.9411073264363707,0.36816502),
c("GO:0016236","macroautophagy",0.08570569846601868,-1.6036670589365174,2.8368243997562486,4.411080711811635,1.432580394,0.9091096447488267,0.35965126),
c("GO:0016310","phosphorylation",7.474579996508841,-6.017127828610758,-1.9951215124898811,6.35164114641232,1.132895614,0.9407742054928228,0.35388296),
c("GO:0016477","cell migration",0.182534145240741,-0.5250961183438823,5.272111016334178,4.739406189097407,1.272577908,0.9762703056533756,0.00847438),
c("GO:0016485","protein processing",0.32609875723244736,-4.718175550451972,1.1927555273542816,4.991407732325726,1.396558063,0.8912697920018093,0.68635985),
c("GO:0016925","protein sumoylation",0.0314191030275163,-5.759184962764619,0.31170812562443323,3.975293915356206,1.465139039,0.9062714017585578,0.25074426),
c("GO:0018108","peptidyl-tyrosine phosphorylation",0.015114165165893928,-5.76945728798108,-0.3727295021393611,3.657533887557986,1.423277923,0.912976493666672,0.45177413),
c("GO:0019563","glycerol catabolic process",0.050853976941318726,-2.47773942023613,3.6817686433814436,4.18440748541232,2.344222462,0.9154888959506023,0.17789645),
c("GO:0030150","protein import into mitochondrial matrix",0.04461073574053023,-0.35150992802762904,-6.33023897429637,4.127525924587694,1.758166847,0.8761506018196829,0.54654169),
c("GO:0030334","regulation of cell migration",0.12853360134367056,7.087174367580124,0.09530526828134668,4.5870820734374975,1.331944581,0.8620581985689637,0.14790529),
c("GO:0030517","negative regulation of axon extension",0.004107833182191682,4.059020142079384,-4.4172004983583815,3.092018470752797,1.87537797,0.7319941882150223,0.61976697),
c("GO:0030574","collagen catabolic process",0.008285516159384193,-1.4785357292384065,2.384971487535298,3.396548037987132,1.758166847,0.9367186870113301,0.31017099),
c("GO:0031638","zymogen activation",0.008398606303671253,-4.13839669371778,0.790093846060995,3.402433346219312,1.841889077,0.9142561340492038,0.26151013),
c("GO:0032733","positive regulation of interleukin-10 production",0.004936052180058668,6.726545243130708,-2.972870112091767,3.171726453653231,2.344222462,0.7493229656747109,0.17405263),
c("GO:0032786","positive regulation of DNA-templated transcription, elongation",0.03708691496472652,6.6704160849438505,-1.9254131799178607,4.0473138158153885,1.674444616,0.7484365312899782,0.52766479),
c("GO:0033627","cell adhesion mediated by integrin",0.004510301048625037,-1.0612384217189885,7.225697354629256,3.132579847659737,1.87537797,0.9586704581321853,0.00511534),
c("GO:0034446","substrate adhesion-dependent cell spreading",0.006639056705793196,-0.8190065843977137,7.238618017333023,3.3003780648707024,1.663641747,0.9537650126126405,0.50118172),
c("GO:0034599","cellular response to oxidative stress",0.20517545736315293,4.813468062580676,4.7367408034165885,4.790186609533173,1.307354835,0.8728196681609045,0.5049582),
c("GO:0035023","regulation of Rho protein signal transduction",0.0204327281281,6.102805044979123,-0.6703486756607661,3.7884512070234555,1.87537797,0.793481811295072,0.6704229),
c("GO:0035092","sperm DNA condensation",0.002454721367172033,0.721983425204767,-6.594104845049511,2.8686444383948255,2.344222462,0.910571914954465,0.00495752),
c("GO:0035335","peptidyl-tyrosine dephosphorylation",0.004477039241481785,-5.5955961078717635,-0.7851702430598406,3.1293675957229854,1.693049556,0.91793625353547,0.13800415),
c("GO:0035556","intracellular signal transduction",3.7944870018179575,5.068924842727434,1.391087567433546,6.0572076090390246,1.115808945,0.7507834447209943,0.59865377),
c("GO:0038061","NIK/NF-kappaB signaling",0.007337554655801498,5.725340583024027,2.6868685496369777,3.343802333161655,1.758166847,0.8325034143173653,0.32791212),
c("GO:0042176","regulation of protein catabolic process",0.1493787758803469,4.280746291710295,-1.4921137900581256,4.652352725284198,2.0837533,0.7820829399445152,0.65554729),
c("GO:0042982","amyloid precursor protein metabolic process",0.005750966455068354,-6.236871216239881,1.615023662571344,3.2380461031287955,2.344222462,0.9390355787085332,0.02800306),
c("GO:0043122","regulation of I-kappaB kinase/NF-kappaB signaling",0.04471052116195999,5.843243290330832,-0.8167494474227359,4.128496198632706,1.87537797,0.7846297264363082,0.51835313),
c("GO:0043162","ubiquitin-dependent protein catabolic process via the multivesicular body sorting pathway",0.03876996240617509,-3.56761874373006,1.5557215197080003,4.066586796470695,2.163897657,0.8694901148113178,0.35068999),
c("GO:0043627","response to estrogen",0.006605794898649943,5.573358932618586,5.034105185319523,3.298197867109815,1.594071274,0.9065706795926414,0.52243339),
c("GO:0043651","linoleic acid metabolic process",0.003000215004321374,-4.268829009225435,5.164759933542228,2.9556877503135057,2.344222462,0.9525097169688346,0.00500849),
c("GO:0045104","intermediate filament cytoskeleton organization",0.02768380208532904,1.7998315066846222,-7.229709234662513,3.9203320715395895,2.051194654,0.9272459500421207,0.34260421),
c("GO:0045945","positive regulation of transcription by RNA polymerase III",0.002381545391456878,7.3137018192765515,-2.133647022949599,2.8555191556678,1.674444616,0.7812019077185496,0.41252978),
c("GO:0046628","positive regulation of insulin receptor signaling pathway",0.00281394888431916,6.9302133084753645,-1.5375336135963436,2.9278834103307068,1.87537797,0.7486926961125493,0.53245238),
c("GO:0046777","protein autophosphorylation",0.0549352006777958,-5.3465781756027,-0.2516303296074506,4.21793116878578,1.346680989,0.9078950538671925,0.29111498),
c("GO:0046784","viral mRNA export from host cell nucleus",0.0010011803950118999,2.4646006817506794,7.410092364859802,2.4800069429571505,2.344222462,0.9589162618537057,0.00474184),
c("GO:0047496","vesicle transport along microtubule",0.004616738831483444,-1.589950104223782,-6.603414233155612,3.1427022457376155,1.87537797,0.9432003834901707,0.47012441),
c("GO:0048260","positive regulation of receptor-mediated endocytosis",0.006639056705793196,6.967828914703749,-2.4460418476842385,3.3003780648707024,1.953518719,0.7553271906315282,0.47808128),
c("GO:0050790","regulation of catalytic activity",0.6743565303837294,4.036096775020406,-0.7664587119816441,5.306945868486873,1.622923243,0.8388649651068179,0.61953825),
c("GO:0050829","defense response to Gram-negative bacterium",0.01786491661664091,3.9979627586872595,5.666040546315961,3.7301360039966776,1.693049556,0.8827189719812715,0.53911956),
c("GO:0051016","barbed-end actin filament capping",0.022667921568126567,3.963909596278807,-4.140846349096202,3.833529581758644,1.758166847,0.7481117696245185,0.69560596),
c("GO:0051017","actin filament bundle assembly",0.023585947445280333,1.7036454422548921,-7.147227003564148,3.85076872692888,1.49177793,0.9236613424517882,0.56969703),
c("GO:0051220","cytoplasmic sequestering of protein",0.0027008587400321016,-2.078665371142424,-6.4590711197405986,2.910090545594068,2.344222462,0.9460645694751055,0.12586049),
c("GO:0051865","protein autoubiquitination",0.015150753153751506,-5.971165037837735,0.2792569539610155,3.6585837154070626,1.385222364,0.9124661584434711,0.55166687),
c("GO:0051923","sulfation",0.02173326478740117,-3.4567924731624973,6.055013540313885,3.8152455919165633,1.803248048,0.9691689049829848,0.54582263),
c("GO:0060347","heart trabecula formation",0.0015500002128755659,-4.9991430310701945,-4.087734394513036,2.6693168805661123,2.0837533,0.9567021877492536,0.35115107),
c("GO:0061844","antimicrobial humoral immune response mediated by antimicrobial peptide",0.005368455672920951,4.140819497317042,5.696683112202272,3.2081725266671217,1.87537797,0.8823979153327973,0.53077697),
c("GO:0070327","thyroid hormone transport",0.0015832620200188184,1.7496481742620345,-4.099452241379709,2.678518379040114,2.344222462,0.8525978936326987,0.105021),
c("GO:0070371","ERK1 and ERK2 cascade",0.006269850646503093,5.450825288424604,2.7524644514136254,3.2755416884013098,2.0837533,0.8338916354045012,0.23613603),
c("GO:0070498","interleukin-1-mediated signaling pathway",0.005308584420063096,4.9415619310980095,2.965307690998484,3.203304916138483,2.0837533,0.8014435154229428,0.17285222),
c("GO:0071711","basement membrane organization",0.004633369735055071,2.4406689903757393,-7.288379184945966,3.144262773761991,1.841889077,0.9514732241775012,0.22865106),
c("GO:0090043","regulation of tubulin deacetylation",0.0024879831743152858,2.221448846504322,-1.0006141808030737,2.8744818176994666,2.0837533,0.8425242696844296,0.5316729),
c("GO:0090110","COPII-coated vesicle cargo loading",0.004054614290762477,-0.046031786320353166,-6.569586463511667,3.0863598306747484,1.87537797,0.9013990039825364,0.46639185),
c("GO:0097009","energy homeostasis",0.0060736059843579035,-3.9091062951537934,-3.325059578169599,3.2617385473525378,1.532760841,0.9606615876299123,0.40480338),
c("GO:0098609","cell-cell adhesion",0.2927438170291938,-0.936457960613799,7.322358985641684,4.944546824551128,1.345045675,0.9485102920805561,0.63651592),
c("GO:0098656","monoatomic anion transmembrane transport",0.450890405272502,-1.8447799794619733,-4.9109160530661535,5.132128356446811,1.87537797,0.9410863930950191,0.20851842),
c("GO:0099072","regulation of postsynaptic membrane neurotransmitter receptor levels",0.006715558862222677,5.123798698796339,-5.076317843308726,3.305351369446624,1.87537797,0.8664131927474474,0.37127129),
c("GO:1900087","positive regulation of G1/S transition of mitotic cell cycle",0.00582414243078351,7.533429060135613,-1.6645166661557078,3.243534101832062,1.516849828,0.787429676068552,0.38640891),
c("GO:1900153","positive regulation of nuclear-transcribed mRNA catabolic process, deadenylation-dependent decay",0.006223284116502539,5.838000400310271,-2.895929484366066,3.2723058444020863,2.051194654,0.7126650023003315,0.68650402),
c("GO:1900273","positive regulation of long-term synaptic potentiation",0.001689699802877226,6.1055719786987135,-2.4924320513297444,2.7067177823367587,1.674444616,0.7400666677104166,0.54266793),
c("GO:1901096","regulation of autophagosome maturation",0.0028971034021772913,6.020328937641053,-4.033780196425647,2.940516484932567,2.344222462,0.8001678581356698,0.00499953),
c("GO:1901998","toxin transport",0.012253649751574214,-3.418880561692026,-5.644934999958656,3.56643749219507,1.562814975,0.9608986373865795,0.16386314),
c("GO:1902042","negative regulation of extrinsic apoptotic signaling pathway via death domain receptors",0.0036654511471864238,4.6395447037598965,-2.2447335898970646,3.0425755124401905,2.051194654,0.7800131620601578,0.55343526),
c("GO:1903076","regulation of protein localization to plasma membrane",0.016404723283052126,7.905700887392623,0.2773965850861253,3.693111115462141,1.674444616,0.8725890064680686,0.56351982),
c("GO:1903671","negative regulation of sprouting angiogenesis",0.0015200645864466384,4.3396267778119695,-4.699836764690816,2.660865478003869,1.87537797,0.8197689924745315,0.4952288),
c("GO:1904263","positive regulation of TORC1 signaling",0.004773069325056732,6.720224759229023,-1.5078059748930701,3.1571544399062814,1.640955724,0.7373712123506974,0.61522766),
c("GO:1990928","response to amino acid starvation",0.011132726850846606,4.530448466587994,5.547689464641834,3.5247854493212225,2.344222462,0.9004126730637239,0),
c("GO:2000352","negative regulation of endothelial cell apoptotic process",0.004107833182191682,3.3046707272992575,-2.8261946447299007,3.092018470752797,1.674444616,0.8403999531549863,0.64556486));

one.data <- data.frame(revigo.data);
names(one.data) <- revigo.names;
one.data <- one.data [(one.data$plot_X != "null" & one.data$plot_Y != "null"), ];
one.data$plot_X <- as.numeric( as.character(one.data$plot_X) );
one.data$plot_Y <- as.numeric( as.character(one.data$plot_Y) );
one.data$log_size <- as.numeric( as.character(one.data$log_size) );
one.data$value <- as.numeric( as.character(one.data$value) );
one.data$frequency <- as.numeric( as.character(one.data$frequency) );
one.data$uniqueness <- as.numeric( as.character(one.data$uniqueness) );
one.data$dispensability <- as.numeric( as.character(one.data$dispensability) );
#head(one.data);


# --------------------------------------------------------------------------
# Names of the axes, sizes of the numbers and letters, names of the columns,
# etc. can be changed below

p1 <- ggplot( data = one.data );
p1 <- p1 + geom_point( aes( plot_X, plot_Y, colour = value, size = log_size), alpha = I(0.6) );
p1 <- p1 + scale_colour_gradientn( colours = c("blue", "green", "yellow", "red"), limits = c( min(one.data$value), 0) );
p1 <- p1 + geom_point( aes(plot_X, plot_Y, size = log_size), shape = 21, fill = "transparent", colour = I (alpha ("black", 0.6) ));
p1 <- p1 + scale_size( range=c(5, 30)) + theme_bw(); # + scale_fill_gradientn(colours = heat_hcl(7), limits = c(-300, 0) );
ex <- one.data [ one.data$dispensability < 0.15, ];
p1 <- p1 + geom_text( data = ex, aes(plot_X, plot_Y, label = description), colour = I(alpha("black", 0.85)), size = 3 );
p1 <- p1 + labs (y = "semantic space x", x = "semantic space y");
p1 <- p1 + theme(legend.key = element_blank()) ;
one.x_range = max(one.data$plot_X) - min(one.data$plot_X);
one.y_range = max(one.data$plot_Y) - min(one.data$plot_Y);
p1 <- p1 + xlim(min(one.data$plot_X)-one.x_range/10,max(one.data$plot_X)+one.x_range/10);
p1 <- p1 + ylim(min(one.data$plot_Y)-one.y_range/10,max(one.data$plot_Y)+one.y_range/10);


# --------------------------------------------------------------------------
# Output the plot to screen

p1;

# Uncomment the line below to also save the plot to a file.
# The file type depends on the extension (default=pdf).

# ggsave("/path_to_your_file/revigo-plot.pdf");

